---
title: リップシンク・トラッキング設定
slug: shapemap
---

{{< hint ms >}}
本ページの以下の内容は、すべてムーンショット版のみの内容です。
{{< /hint >}}

# リップシンク・トラッキングの設定 (.shapemap)

CGエージェントをアバターとして外部から制御するとき、外部からの信号に対して表示するCGアバターをどのように動かすかを定義する必要があります。具体的には、外部から送られるAPI命令やトラッキング情報、音声データから自動抽出される音素情報のそれぞれに対して、CGアバターの「どの部位を」「どのように」対応させて動かすかを指定します。

MMDAgent-EXでは、このためにモデルごとに設定ファイル (.shapemap) を定義します。設定ファイルでは、それぞれの指示信号に対してモデルのボーンやモーフの対応付けを定義します。関連する機能は以下の通りです。

- **SPEAK_START** コマンドによる音声再生における自動リップシンク
- 外部APIからの音声流し込みによる自動リップシンク
- ヘッドトラッキング・フェイシャルトラッキング

設定ファイル（.shapemap）が定義されていないCGモデルは、外部APIや音声の自動リップシンクに対して反応しません。アバターとしてCGエージェントを利用する場合、3Dモデルごとに .shapemap を用意してください。

## .shapemap ファイル

設定ファイル（.shapemap）は、モデルファイル (`xxx.pmd`) と同じフォルダに `xxx.pmd.shapemap` という名前で置きます。
テキストファイルで、中身は以下のようになっています。`#` で始まる行はコメントで無視されます。

```text
#### リップシンク用モーフ名
LIP_A あ
LIP_I い
LIP_U う
LIP_O お

#### リップシンク中に０にリセットするモーフ名のリスト
#### 上記で指定した以外の、口を開けるモーフを全て指定する
NOLIP え,おお~,ワ,えー,ああ,いい,叫び,あーれー,口わらい,mouth_a_geo_C,mouth_i_geo_C,mouth_u_geo_C,mouth_e_geo_C,mouth_o_geo_C,mouth_oh_geo_C,mouth_smile_geo_C,mouth_surprise_geo
```

以下、設定可能な項目について解説します。

## リップシンク設定

## ボーントラッキング設定

## フェイシャルトラッキング設定: Action Unit

## フェイシャルトラッキング設定: ARKit Shapes

## 個別ボーン制御設定

## 個別モーフ制御設定
